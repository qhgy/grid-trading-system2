<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网格交易系统 - 网格交易系统2.0</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            border: 1px solid rgba(0, 0, 0, 0.125);
        }
        .navbar-brand {
            font-weight: bold;
        }
        .grid-item {
            transition: all 0.3s ease;
        }
        .grid-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .status-waiting {
            background-color: #fff3cd;
            color: #856404;
        }
        .status-bought {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        .status-sold {
            background-color: #d4edda;
            color: #155724;
        }
        .profit-positive {
            color: #28a745;
            font-weight: bold;
        }
        .profit-negative {
            color: #dc3545;
            font-weight: bold;
        }
        .chart-container {
            height: 300px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="bi bi-grid-3x3-gap"></i> 网格交易系统 2.0
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="showSection('grid')">
                            <i class="bi bi-grid"></i> 网格设置
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('trades')">
                            <i class="bi bi-list-ul"></i> 交易记录
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('stats')">
                            <i class="bi bi-bar-chart"></i> 收益统计
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('settings')">
                            <i class="bi bi-gear"></i> 设置
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">
                            <i class="bi bi-house"></i> 首页
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="calculator.html">
                            <i class="bi bi-calculator"></i> 计算器
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- 欢迎信息 -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="alert alert-info">
                    <h5><i class="bi bi-info-circle"></i> 网格交易系统 2.0</h5>
                    <p class="mb-0">
                        支持2.1留利润版、2.2逐格加码版、2.3一网打尽版。基于ETF拯救世界7年实战经验。
                        <strong>投资有风险，请谨慎操作。</strong>
                    </p>
                </div>
            </div>
        </div>

        <!-- 网格设置页面 -->
        <div id="grid-section" class="section">
            <div class="row">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-plus-circle"></i> 创建2.0网格</h5>
                        </div>
                        <div class="card-body">
                            <form id="grid-form">
                                <div class="mb-3">
                                    <label class="form-label">网格策略版本</label>
                                    <select class="form-select" id="gridVersion" required>
                                        <option value="2.1">2.1 留利润版</option>
                                        <option value="2.2">2.2 逐格加码版</option>
                                        <option value="2.3">2.3 一网打尽版</option>
                                        <option value="1.0">1.0 基础版（参考）</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">品种名称</label>
                                    <div class="input-group">
                                        <select class="form-select" id="symbol" required onchange="handleSymbolChange()">
                                            <option value="">-- 选择预设品种 --</option>
                                            <optgroup label="指数ETF（推荐）">
                                                <option value="510500">中证500ETF (510500)</option>
                                                <option value="510300">沪深300ETF (510300)</option>
                                                <option value="159915">创业板ETF (159915)</option>
                                                <option value="588000">科创50ETF (588000)</option>
                                            </optgroup>
                                            <optgroup label="行业ETF">
                                                <option value="515000">科技ETF (515000)</option>
                                                <option value="512880">券商ETF (512880)</option>
                                                <option value="512800">银行ETF (512800)</option>
                                                <option value="512120">医药ETF (512120)</option>
                                                <option value="159928">消费ETF (159928)</option>
                                            </optgroup>
                                            <optgroup label="商品ETF">
                                                <option value="518880">黄金ETF (518880)</option>
                                                <option value="518290">白银ETF (518290)</option>
                                                <option value="159930">原油ETF (159930)</option>
                                            </optgroup>
                                            <optgroup label="海外ETF">
                                                <option value="513100">纳指ETF (513100)</option>
                                                <option value="513500">标普500ETF (513500)</option>
                                            </optgroup>
                                            <option value="custom">🔧 自定义品种</option>
                                        </select>
                                        <button class="btn btn-outline-secondary" type="button" onclick="showCustomInput()">
                                            <i class="bi bi-plus"></i>
                                        </button>
                                    </div>
                                    <input type="text" class="form-control mt-2" id="customSymbol"
                                           placeholder="请输入自定义品种名称和代码（如：比特币 BTC、茅台 600519）"
                                           style="display: none;">
                                    <small class="text-muted mt-1" style="display: block;">
                                        💡 提示：推荐选择指数ETF，风险相对较低。自定义品种请谨慎评估风险。
                                    </small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">起始价格</label>
                                    <input type="number" class="form-control" id="startPrice" step="0.001" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">网格间距 (%)</label>
                                    <input type="number" class="form-control" id="gridSize" value="5" min="1" max="20" required>
                                </div>
                                
                                <!-- 基础参数 -->
                                <div id="basic-params">
                                    <div class="mb-3">
                                        <label class="form-label">每格金额</label>
                                        <input type="number" class="form-control" id="gridAmount" value="10000" min="1000" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">网格数量</label>
                                        <input type="number" class="form-control" id="gridCount" value="10" min="5" max="20" required>
                                    </div>
                                </div>

                                <!-- 2.1留利润版参数 -->
                                <div id="profit-retention-params" style="display: none;">
                                    <div class="mb-3">
                                        <label class="form-label">留利润策略</label>
                                        <select class="form-select" id="retentionType">
                                            <option value="basic">基础留利润</option>
                                            <option value="double">留双份利润</option>
                                            <option value="triple">留三份利润</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- 2.2逐格加码版参数 -->
                                <div id="progressive-params" style="display: none;">
                                    <div class="mb-3">
                                        <label class="form-label">加码比例 (%)</label>
                                        <input type="number" class="form-control" id="progressiveRate" value="5" min="0" max="20">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">从第几格开始加码</label>
                                        <input type="number" class="form-control" id="progressiveStart" value="2" min="1" max="5">
                                    </div>
                                </div>

                                <!-- 2.3一网打尽版参数 -->
                                <div id="multi-grid-params" style="display: none;">
                                    <div class="mb-3">
                                        <label class="form-label">总资金</label>
                                        <input type="number" class="form-control" id="totalFunds" value="100000" min="10000" step="10000">
                                    </div>
                                    <div class="row">
                                        <div class="col-4">
                                            <label class="form-label">小网(5%)</label>
                                            <input type="number" class="form-control" id="smallGridRatio" value="40" min="20" max="60">
                                            <small class="text-muted">资金占比%</small>
                                        </div>
                                        <div class="col-4">
                                            <label class="form-label">中网(15%)</label>
                                            <input type="number" class="form-control" id="mediumGridRatio" value="35" min="20" max="50">
                                            <small class="text-muted">资金占比%</small>
                                        </div>
                                        <div class="col-4">
                                            <label class="form-label">大网(30%)</label>
                                            <input type="number" class="form-control" id="largeGridRatio" value="25" min="15" max="40">
                                            <small class="text-muted">资金占比%</small>
                                        </div>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary w-100 mt-3">
                                    <i class="bi bi-plus"></i> 创建2.0网格
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- 压力测试 -->
                    <div class="card mt-3">
                        <div class="card-header">
                            <h6><i class="bi bi-shield-check"></i> 压力测试</h6>
                        </div>
                        <div class="card-body">
                            <div id="stress-test-result">
                                <p class="text-muted">请先设置网格参数</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5><i class="bi bi-grid-3x3"></i> 当前网格</h5>
                            <div>
                                <button class="btn btn-sm btn-outline-primary" onclick="refreshPrices()">
                                    <i class="bi bi-arrow-clockwise"></i> 刷新价格
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="grid-display">
                                <div class="text-center text-muted py-5">
                                    <i class="bi bi-grid-3x3 display-1"></i>
                                    <p>暂无网格，请创建新的网格交易</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 其他页面内容保持不变 -->
        <div id="trades-section" class="section" style="display: none;">
            <div class="card">
                <div class="card-header">
                    <h5><i class="bi bi-list-ul"></i> 交易记录</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>日期</th>
                                    <th>类型</th>
                                    <th>品种</th>
                                    <th>价格</th>
                                    <th>数量</th>
                                    <th>金额</th>
                                    <th>收益</th>
                                </tr>
                            </thead>
                            <tbody id="trades-table">
                                <tr>
                                    <td colspan="7" class="text-center text-muted">暂无交易记录</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="stats-section" class="section" style="display: none;">
            <div class="row">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-primary">总收益</h5>
                            <h3 id="total-profit">¥0.00</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">收益率</h5>
                            <h3 id="profit-rate">0.00%</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-info">交易次数</h5>
                            <h3 id="trade-count">0</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-warning">胜率</h5>
                            <h3 id="win-rate">0.00%</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="settings-section" class="section" style="display: none;">
            <div class="row">
                <!-- 云端存储 -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="bi bi-cloud"></i> 云端存储</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <small class="text-muted">状态: </small>
                                <span id="cloud-status" class="fw-bold">检查中...</span>
                            </div>
                            <button class="btn btn-primary w-100 mb-2" onclick="app.backupToCloud()">
                                <i class="bi bi-cloud-upload"></i> 备份到云端
                            </button>
                            <button class="btn btn-outline-primary w-100 mb-2" onclick="app.restoreFromCloud()">
                                <i class="bi bi-cloud-download"></i> 从云端恢复
                            </button>
                            <button class="btn btn-outline-secondary w-100" onclick="app.showCloudSetup()">
                                <i class="bi bi-gear"></i> 云端设置
                            </button>
                            <div class="mt-2">
                                <small class="text-muted">
                                    <i class="bi bi-shield-check"></i> 使用GitHub Gist安全存储，完全免费
                                </small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 本地数据管理 -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-database"></i> 本地数据管理</h5>
                        </div>
                        <div class="card-body">
                            <button class="btn btn-outline-success w-100 mb-2" onclick="backupData()">
                                <i class="bi bi-download"></i> 导出到文件
                            </button>
                            <button class="btn btn-outline-info w-100 mb-2" onclick="restoreData()">
                                <i class="bi bi-upload"></i> 从文件导入
                            </button>
                            <button class="btn btn-outline-danger w-100" onclick="clearData()">
                                <i class="bi bi-trash"></i> 清空所有数据
                            </button>
                            <div class="mt-2">
                                <small class="text-muted">
                                    <i class="bi bi-info-circle"></i> 本地文件备份，适合离线使用
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <!-- 通知设置 -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-bell"></i> 通知设置</h5>
                        </div>
                        <div class="card-body">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="enableNotifications">
                                <label class="form-check-label" for="enableNotifications">
                                    启用价格提醒
                                </label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="enableSound">
                                <label class="form-check-label" for="enableSound">
                                    启用声音提醒
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 系统信息 -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-info-circle"></i> 系统信息</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-6">
                                    <small class="text-muted">版本</small>
                                    <div class="fw-bold">2.0</div>
                                </div>
                                <div class="col-6">
                                    <small class="text-muted">网格数量</small>
                                    <div class="fw-bold" id="grid-count">0</div>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-6">
                                    <small class="text-muted">交易记录</small>
                                    <div class="fw-bold" id="trade-records">0</div>
                                </div>
                                <div class="col-6">
                                    <small class="text-muted">数据大小</small>
                                    <div class="fw-bold" id="data-size">0 KB</div>
                                </div>
                            </div>
                            <div class="mt-3">
                                <small class="text-muted">
                                    基于ETF拯救世界7年实战经验 ❤️
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 自定义JS -->
    <script src="js/app.js"></script>
</body>
</html>
